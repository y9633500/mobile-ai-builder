from flask import Flask, request, jsonify\nfrom flask_sqlalchemy import SQLAlchemy\nfrom werkzeug.security import generate_password_hash, check_password_hash\nimport jwt\nimport datetime\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'your_secret_key'\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///users.db'\ndb = SQLAlchemy(app)\n\nclass User(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    username = db.Column(db.String(80), unique=True, nullable=False)\n    password = db.Column(db.String(120), nullable=False)\n\n@app.route('/register', methods=['POST'])\ndef register():\n    data = request.get_json()\n    hashed_password = generate_password_hash(data['password'], method='sha256')\n    new_user = User(username=data['username'], password=hashed_password)\n    \n    db.create_all()\n    db.session.add(new_user)\n    db.session.commit()\n    \n    return jsonify({'message': 'User registered successfully!'})\n\n@app.route('/login', methods=['POST'])\ndef login():\n    data = request.get_json()\n    user = User.query.filter_by(username=data['username']).first()\n    \n    if not user or not check_password_hash(user.password, data['password']):\n        return jsonify({'message': 'Login failed!'})\n\n    token = jwt.encode({'user_id': user.id, 'exp': datetime.datetime.utcnow() + datetime.timedelta(minutes=30)}, app.config['SECRET_KEY'])\n    return jsonify({'token': token})\n\nif __name__ == '__main__':\n    app.run(debug=True)\n